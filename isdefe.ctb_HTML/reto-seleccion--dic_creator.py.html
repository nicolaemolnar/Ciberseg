<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>dic_creator.py</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>dic_creator.py</h1><br/><pre><span style="color:#333333;font-weight:400">import</span> os<br /><span style="color:#333333;font-weight:400">import</span> sys<br /><span style="color:#333333;font-weight:400">import</span> time<br /><span style="color:#333333;font-weight:400">import</span> string<br /><span style="color:#333333;font-weight:400">import</span> argparse<br /><span style="color:#333333;font-weight:400">import</span> itertools<br /><br /><br /><span style="color:#ff9d00;font-weight:700">def</span> <span style="color:#333333;font-weight:400">createWordList</span>(chrs, min_length, max_length, output):<br />    <span style="color:#3ad900;font-weight:400">&quot;&quot;&quot;<br />    :param `chrs` is characters to iterate.<br />    :param `min_length` is minimum length of characters.<br />    :param `max_length` is maximum length of characters.<br />    :param `output` is output of wordlist file.<br />    &quot;&quot;&quot;</span><br />    <span style="color:#ff9d00;font-weight:700">if</span> min_length &gt; max_length:<br />        <span style="color:#ff9d00;font-weight:700">print</span> (<span style="color:#3ad900;font-weight:400">&quot;[!] Please `min_length` must smaller or same as with `max_length`&quot;</span>)<br />        sys.exit()<br /><br />    <span style="color:#ff9d00;font-weight:700">if</span> os.path.exists(os.path.dirname(output)) == <span style="color:#ff0044;font-weight:400">False</span>:<br />        os.makedirs(os.path.dirname(output))<br /><br />    <span style="color:#ff9d00;font-weight:700">print</span> (<span style="color:#3ad900;font-weight:400">&#39;[+] Creating wordlist at `%s`...&#39;</span> % output)<br />    <span style="color:#ff9d00;font-weight:700">print</span> (<span style="color:#3ad900;font-weight:400">&#39;[i] Starting time: %s&#39;</span> % time.strftime(<span style="color:#3ad900;font-weight:400">&#39;%H:%M:%S&#39;</span>))<br /><br />    output = <span style="color:#ff9d00;font-weight:700">open</span>(output, <span style="color:#3ad900;font-weight:400">&#39;w&#39;</span>)<br /><br />    <span style="color:#ff9d00;font-weight:700">for</span> n <span style="color:#ff9d00;font-weight:700">in</span> <span style="color:#ff9d00;font-weight:700">range</span>(min_length, max_length + <span style="color:#ff0044;font-weight:400">1</span>):<br />        <span style="color:#ff9d00;font-weight:700">for</span> xs <span style="color:#ff9d00;font-weight:700">in</span> itertools.product(chrs, repeat=n):<br />            chars = <span style="color:#3ad900;font-weight:400">&#39;&#39;</span>.join(xs)<br />            output.write(<span style="color:#3ad900;font-weight:400">&quot;%s\n&quot;</span> % chars)<br />            sys.stdout.write(<span style="color:#3ad900;font-weight:400">&#39;\r[+] saving character `%s`&#39;</span> % chars)<br />            sys.stdout.flush()<br />    output.close()<br /><br />    <span style="color:#ff9d00;font-weight:700">print</span> (<span style="color:#3ad900;font-weight:400">&#39;\n[i] End time: %s&#39;</span> % time.strftime(<span style="color:#3ad900;font-weight:400">&#39;%H:%M:%S&#39;</span>))<br /><br /><br /><span style="color:#ff9d00;font-weight:700">if</span> <span style="color:#333333;font-weight:400">__name__</span> == <span style="color:#3ad900;font-weight:400">&#39;__main__&#39;</span>:<br />    parser = argparse.ArgumentParser(<br />        formatter_class=argparse.RawTextHelpFormatter,<br />        description=<span style="color:#3ad900;font-weight:400">&#39;Python Wordlist Generator&#39;</span>)<br />    parser.add_argument(<br />        <span style="color:#3ad900;font-weight:400">&#39;-chr&#39;</span>, <span style="color:#3ad900;font-weight:400">&#39;--chars&#39;</span>,<br />        default=<span style="color:#ff0044;font-weight:700">None</span>, help=<span style="color:#3ad900;font-weight:400">&#39;characters to iterate&#39;</span>)<br />    parser.add_argument(<br />        <span style="color:#3ad900;font-weight:400">&#39;-min&#39;</span>, <span style="color:#3ad900;font-weight:400">&#39;--min_length&#39;</span>, <span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff9d00;font-weight:700">int</span>,<br />        default=<span style="color:#ff0044;font-weight:400">1</span>, help=<span style="color:#3ad900;font-weight:400">&#39;minimum length of characters&#39;</span>)<br />    parser.add_argument(<br />        <span style="color:#3ad900;font-weight:400">&#39;-max&#39;</span>, <span style="color:#3ad900;font-weight:400">&#39;--max_length&#39;</span>, <span style="color:#ff9d00;font-weight:700">type</span>=<span style="color:#ff9d00;font-weight:700">int</span>,<br />        default=<span style="color:#ff0044;font-weight:400">2</span>, help=<span style="color:#3ad900;font-weight:400">&#39;maximum length of characters&#39;</span>)<br />    parser.add_argument(<br />        <span style="color:#3ad900;font-weight:400">&#39;-out&#39;</span>, <span style="color:#3ad900;font-weight:400">&#39;--output&#39;</span>,<br />        default=<span style="color:#3ad900;font-weight:400">&#39;output/wordlist.txt&#39;</span>, help=<span style="color:#3ad900;font-weight:400">&#39;output of wordlist file.&#39;</span>)<br /><br />    args = parser.parse_args()<br />    <span style="color:#ff9d00;font-weight:700">if</span> args.chars <span style="color:#ff9d00;font-weight:700">is</span> <span style="color:#ff0044;font-weight:700">None</span>:<br />        args.chars = string.printable.replace(<span style="color:#3ad900;font-weight:400">&#39; \t\n\r\x0b\x0c&#39;</span>, <span style="color:#3ad900;font-weight:400">&#39;&#39;</span>)<br />    createWordList(args.chars, args.min_length, args.max_length, args.output)</pre></div>
</body>
</html>
