<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Enumeration</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Enumeration</h1><br/>Relevant information obtain by enumeration on the target file:<br />→ <strong>Type of File</strong>: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, not stripped<br />→ <strong>Execution</strong>:<br />      ⇒ <strong>Input</strong>: None<br />      ⇒ <strong>Output</strong>: <em>“La clave no es flag{ASM} }:)”</em><br />→ <strong>Contents</strong>:<br />      ⇒ 2 Relevant strings: <br />         • <em>La </em><em><span style="text-decoration:underline;">clave </span></em><em>no es flag{</em><em><span style="text-decoration:underline;">ASM</span></em><em>} }:)</em><br />         • <em>La </em><em><span style="text-decoration:underline;">flag</span></em><em> no es flag{</em><em><span style="text-decoration:underline;">asm</span></em><em>} }:)</em><br />      ⇒ The previous strings are barely different, but this difference may be a hint to find the flag. ¿What is ASM/asm?<br />         •  ASM seems to fit for assembly code. I find no obvious relation between ASM and asm but the ascii difference between caps.<br />         •  The strings command shows <em>“the.asm”</em>  which we can assume to be an assembly file, maybe hidden in the elf.<br />      ⇒ While running the strings command we notice a series of strings “flagX” with X in [1,25] and a string “the_flag”, we suppose these are variable names whose content we could see in gdb.<br />      ⇒ Also, from the 2 relevant strings found earlier, only one is visible by the command strings. This is, the strings with “asm” instead of “ASM” is not declared as an explicit string, or hidden somehow. <span style="text-decoration:underline;">“La flag no es flag{asm} }:)”</span> has become a potential hint to find the flag.<br />→ <strong>GDB Debugging</strong>: Check the “Enumeration/gdb” file for a detailed report of the GDB analysis.<br />   ⇒ Our assumptions about the strings command output were true, each flagX variable contains a character from the “La flag no es flag{asm} }”.<br />   ⇒ Nevertheless, the_flag contains the character ‘\n’, but is also the argument of the asm instruction <strong>callq</strong>, meaning the_flag is also a procedure. This information is confusing.<br />   ⇒ There are no signs of a variable containing the string “La clave no es flag{ASM} }:)”, so we assume its hard-coded in the program.<br />→ <strong>ELFTOC</strong>: Tool that creates a C struct that replicates the memory state of an elf. The file “Enumeration/nope.c” has further details.<br />   ⇒ Most of the data seems invaluable for the problem but in the data section we can find two strings:<br />      • <span style="color:#3ad900;">&quot;La clave no es flag{ASM} }:)\n&quot;</span>  →  Normal hard-coded string.<br />      • <span style="color:#3ad900;">&quot;\0L\0a\0 \0f\0l\0a\0g\0 \0n\0o\0 \0e\0s\0 \0f\0l\0a\0g\0{\0a\0s\0m\0}\0 \0}:)&quot;</span>  →  “La flag no es flag{asm} }:)” hidden with ‘\0&#39; characters.<br />   ⇒ In the symbol table section, we discovered:<br />      • the.asm actually is an assembly file we should try to open.<br />      • All the flagX vars are defined as data while the_flag is defined as text, both defined in ReadOnly data.<br />→ <strong>HEXEDIT</strong>: We obtained the same reuslts as ELFTOC.</div>
</body>
</html>
