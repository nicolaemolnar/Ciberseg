<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>snow_decrypt.py</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>snow_decrypt.py</h1><br/><pre><br /><span style="color:#333333;font-weight:400">import</span> os<br /><br />dict_file = <span style="color:#ff9d00;font-weight:700">open</span>(<span style="color:#3ad900;font-weight:400">&#39;../wordlists/snow_brute.txt&#39;</span>, <span style="color:#3ad900;font-weight:400">&#39;r&#39;</span>) <span style="color:#0088ff;font-weight:400"># Open wordlist file</span><br />res_file = <span style="color:#ff9d00;font-weight:700">open</span>(<span style="color:#3ad900;font-weight:400">&#39;result.txt&#39;</span>, <span style="color:#3ad900;font-weight:400">&#39;r&#39;</span>) <span style="color:#0088ff;font-weight:400"># Output file from the snow execution</span><br /><br />count = <span style="color:#ff0044;font-weight:400">0</span><br /><span style="color:#ff9d00;font-weight:700">for</span> line <span style="color:#ff9d00;font-weight:700">in</span> dict_file:<br />    <span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;Trying with: %10s, tried: %5d times.&quot;</span>%(line.replace(<span style="color:#3ad900;font-weight:400">&#39;\n&#39;</span>,<span style="color:#3ad900;font-weight:400">&#39;&#39;</span>),count),end=<span style="color:#3ad900;font-weight:400">&#39;\r&#39;</span>)<br />    <br />    <span style="color:#0088ff;font-weight:400"># Run stegsnow against &#39;line&#39; passphrase</span><br />    os.system(<span style="color:#3ad900;font-weight:400">&#39;stegsnow -Q -p &quot;%s&quot; flags/flag4.txt result.txt&#39;</span> % line) <br />    <br />    <span style="color:#0088ff;font-weight:400"># Read the output file and check for &#39;flag&#39; string in its content</span><br />    text = res_file.read()<br />    count += <span style="color:#ff0044;font-weight:400">1</span><br />    <span style="color:#ff9d00;font-weight:700">if</span> <span style="color:#3ad900;font-weight:400">&#39;flag&#39;</span> <span style="color:#ff9d00;font-weight:700">in</span> res_file.read():<br />        <span style="color:#ff9d00;font-weight:700">print</span>(line)<br />        <span style="color:#ff9d00;font-weight:700">break</span><br /><span style="color:#ff9d00;font-weight:700">else</span>:<br />	<span style="color:#ff9d00;font-weight:700">print</span>(<span style="color:#3ad900;font-weight:400">&quot;The file flag4.txt couldn&#39;t be extracted with any passphrase of snow_brute&quot;</span>)<br /><br /><span style="color:#0088ff;font-weight:400"># Close the opened streams</span><br />res_file.close()<br />dict_file.close()<br />    <br /></pre></div>
</body>
</html>
