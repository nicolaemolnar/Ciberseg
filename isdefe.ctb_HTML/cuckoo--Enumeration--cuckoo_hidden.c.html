<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>cuckoo_hidden.c</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>cuckoo_hidden.c</h1><br/><pre><span style="color:#7f0044;font-weight:700">#include &lt;stddef.h&gt;</span><br /><span style="color:#7f0044;font-weight:700">#include &lt;elf.h&gt;</span><br /><br /><span style="color:#7f0044;font-weight:700">#define ADDR_TEXT 0x00400000</span><br /><br /><span style="color:#ff9d00;font-weight:700">enum</span> sections<br />{<br />  SHN_TEXT = <span style="color:#ff0044;font-weight:400">1</span>, SHN_DATA, SHN_SYMTAB, SHN_STRTAB, SHN_SHSTRTAB, SHN_COUNT<br />};<br /><br /><span style="color:#ff9d00;font-weight:700">typedef</span> <span style="color:#ff9d00;font-weight:700">struct</span> elf<br />{<br />  Elf64_Ehdr      ehdr;<br />  Elf64_Phdr      phdrs[<span style="color:#ff0044;font-weight:400">3</span>];<br />  <span style="color:#7f0044;font-weight:400">unsigned</span> <span style="color:#7f0044;font-weight:400">char</span>   pad1[<span style="color:#ff0044;font-weight:400">3864</span>];<br />  <span style="color:#7f0044;font-weight:400">unsigned</span> <span style="color:#7f0044;font-weight:400">char</span>   text[<span style="color:#ff0044;font-weight:400">256</span>];<br />  <span style="color:#7f0044;font-weight:400">unsigned</span> <span style="color:#7f0044;font-weight:400">char</span>   pad2[<span style="color:#ff0044;font-weight:400">3840</span>];<br />  <span style="color:#7f0044;font-weight:400">unsigned</span> <span style="color:#7f0044;font-weight:400">char</span>   data[<span style="color:#ff0044;font-weight:400">81</span>];<br />  <span style="color:#7f0044;font-weight:400">unsigned</span> <span style="color:#7f0044;font-weight:400">char</span>   pad3[<span style="color:#ff0044;font-weight:400">7</span>];<br />  Elf64_Sym       symtab[<span style="color:#ff0044;font-weight:400">18</span>];<br />  <span style="color:#7f0044;font-weight:400">char</span>            strtab[<span style="color:#ff0044;font-weight:400">110</span>];<br />  <span style="color:#7f0044;font-weight:400">char</span>            shstrtab[<span style="color:#ff0044;font-weight:400">39</span>];<br />  <span style="color:#7f0044;font-weight:400">unsigned</span> <span style="color:#7f0044;font-weight:400">char</span>   pad4[<span style="color:#ff0044;font-weight:400">3</span>];<br />  Elf64_Shdr      shdrs[SHN_COUNT];<br />} elf;<br /><br />elf foo =<br />{<br />  <span style="color:#0088ff;font-weight:400">/* ehdr */</span><br />  {<br />    { <span style="color:#ff0044;font-weight:400">0x7F</span>, <span style="color:#00117f;font-weight:400">&#39;E&#39;</span>, <span style="color:#00117f;font-weight:400">&#39;L&#39;</span>, <span style="color:#00117f;font-weight:400">&#39;F&#39;</span>, ELFCLASS64, ELFDATA2LSB, EV_CURRENT, ELFOSABI_SYSV,<br />      <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    ET_EXEC, EM_X86_64, EV_CURRENT, ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">14</span>,<br />    <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, phdrs), <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, shdrs), <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff9d00;font-weight:400">sizeof</span>(Elf64_Ehdr),<br />    <span style="color:#ff9d00;font-weight:400">sizeof</span>(Elf64_Phdr), <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.phdrs / <span style="color:#ff9d00;font-weight:400">sizeof</span> *foo.phdrs,<br />    <span style="color:#ff9d00;font-weight:400">sizeof</span>(Elf64_Shdr), <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.shdrs / <span style="color:#ff9d00;font-weight:400">sizeof</span> *foo.shdrs, SHN_SHSTRTAB<br />  },<br />  <span style="color:#0088ff;font-weight:400">/* phdrs */</span><br />  {<br />    { PT_LOAD, PF_R, <span style="color:#ff0044;font-weight:400">0</span>, ADDR_TEXT, ADDR_TEXT, <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, pad1),<br />      <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, pad1), <span style="color:#ff0044;font-weight:400">0x1000</span> },<br />    { PT_LOAD, PF_R | PF_X, <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text),<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text), ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text),<br />      <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.text, <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.text, <span style="color:#ff0044;font-weight:400">0x1000</span> },<br />    { PT_LOAD, PF_R | PF_W, <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data),<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data), ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data),<br />      <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.data, <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.data, <span style="color:#ff0044;font-weight:400">0x1000</span> }<br />  },<br />  <span style="color:#0088ff;font-weight:400">/* pad1 */</span><br />  { <span style="color:#ff0044;font-weight:400">0</span> },<br />  <span style="color:#0088ff;font-weight:400">/* text */</span><br />  {<br />    <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x8D</span>, <span style="color:#ff0044;font-weight:400">0x34</span>, <span style="color:#ff0044;font-weight:400">0x25</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x20</span>, <span style="color:#ff0044;font-weight:400">0x40</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xE8</span>, <span style="color:#ff0044;font-weight:400">0xBE</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xC3</span>, <span style="color:#ff0044;font-weight:400">0xE8</span>, <span style="color:#ff0044;font-weight:400">0x05</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xE9</span>, <span style="color:#ff0044;font-weight:400">0xDC</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0x55</span>, <span style="color:#ff0044;font-weight:400">0x68</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xCA</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x89</span>, <span style="color:#ff0044;font-weight:400">0xE5</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x81</span>, <span style="color:#ff0044;font-weight:400">0xEC</span>,<br />    <span style="color:#ff0044;font-weight:400">0x02</span>, <span style="color:#ff0044;font-weight:400">0x01</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0xC7</span>, <span style="color:#ff0044;font-weight:400">0x85</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xB8</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xBF</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x48</span>,<br />    <span style="color:#ff0044;font-weight:400">0x31</span>, <span style="color:#ff0044;font-weight:400">0xD2</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0x8B</span>, <span style="color:#ff0044;font-weight:400">0x95</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x8D</span>, <span style="color:#ff0044;font-weight:400">0xB4</span>,<br />    <span style="color:#ff0044;font-weight:400">0x15</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x31</span>, <span style="color:#ff0044;font-weight:400">0xD2</span>, <span style="color:#ff0044;font-weight:400">0xBA</span>, <span style="color:#ff0044;font-weight:400">0x01</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x0F</span>, <span style="color:#ff0044;font-weight:400">0x05</span>, <span style="color:#ff0044;font-weight:400">0x8A</span>, <span style="color:#ff0044;font-weight:400">0x16</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0x31</span>, <span style="color:#ff0044;font-weight:400">0xC9</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0x8B</span>, <span style="color:#ff0044;font-weight:400">0x8D</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>,<br />    <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xC1</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0x89</span>, <span style="color:#ff0044;font-weight:400">0x8D</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>,<br />    <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0x80</span>, <span style="color:#ff0044;font-weight:400">0xFA</span>, <span style="color:#ff0044;font-weight:400">0x0A</span>, <span style="color:#ff0044;font-weight:400">0x75</span>, <span style="color:#ff0044;font-weight:400">0xBF</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0x31</span>, <span style="color:#ff0044;font-weight:400">0xD2</span>, <span style="color:#ff0044;font-weight:400">0x66</span>, <span style="color:#ff0044;font-weight:400">0x8B</span>, <span style="color:#ff0044;font-weight:400">0x95</span>,<br />    <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xC6</span>, <span style="color:#ff0044;font-weight:400">0x84</span>, <span style="color:#ff0044;font-weight:400">0x15</span>, <span style="color:#ff0044;font-weight:400">0xFD</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x81</span>, <span style="color:#ff0044;font-weight:400">0xC4</span>, <span style="color:#ff0044;font-weight:400">0x02</span>, <span style="color:#ff0044;font-weight:400">0x01</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x5A</span>, <span style="color:#ff0044;font-weight:400">0x81</span>, <span style="color:#ff0044;font-weight:400">0xFA</span>, <span style="color:#ff0044;font-weight:400">0xFE</span>, <span style="color:#ff0044;font-weight:400">0xCA</span>,<br />    <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x74</span>, <span style="color:#ff0044;font-weight:400">0x0F</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x8D</span>, <span style="color:#ff0044;font-weight:400">0x34</span>, <span style="color:#ff0044;font-weight:400">0x25</span>, <span style="color:#ff0044;font-weight:400">0x3E</span>, <span style="color:#ff0044;font-weight:400">0x20</span>, <span style="color:#ff0044;font-weight:400">0x40</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0xE8</span>, <span style="color:#ff0044;font-weight:400">0x2A</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xEB</span>, <span style="color:#ff0044;font-weight:400">0x0D</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x8D</span>, <span style="color:#ff0044;font-weight:400">0x34</span>, <span style="color:#ff0044;font-weight:400">0x25</span>, <span style="color:#ff0044;font-weight:400">0x20</span>,<br />    <span style="color:#ff0044;font-weight:400">0x20</span>, <span style="color:#ff0044;font-weight:400">0x40</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xE8</span>, <span style="color:#ff0044;font-weight:400">0x1B</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x5D</span>, <span style="color:#ff0044;font-weight:400">0xC3</span>, <span style="color:#ff0044;font-weight:400">0x55</span>, <span style="color:#ff0044;font-weight:400">0x48</span>,<br />    <span style="color:#ff0044;font-weight:400">0x89</span>, <span style="color:#ff0044;font-weight:400">0xE5</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x31</span>, <span style="color:#ff0044;font-weight:400">0xD2</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xC2</span>, <span style="color:#ff0044;font-weight:400">0xB3</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x3A</span>, <span style="color:#ff0044;font-weight:400">0x1C</span>,<br />    <span style="color:#ff0044;font-weight:400">0x16</span>, <span style="color:#ff0044;font-weight:400">0x75</span>, <span style="color:#ff0044;font-weight:400">0xF6</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x31</span>, <span style="color:#ff0044;font-weight:400">0xC0</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x8D</span>, <span style="color:#ff0044;font-weight:400">0x02</span>, <span style="color:#ff0044;font-weight:400">0x5D</span>, <span style="color:#ff0044;font-weight:400">0xC3</span>, <span style="color:#ff0044;font-weight:400">0x55</span>,<br />    <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x89</span>, <span style="color:#ff0044;font-weight:400">0xE5</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x83</span>, <span style="color:#ff0044;font-weight:400">0xEC</span>, <span style="color:#ff0044;font-weight:400">0x10</span>, <span style="color:#ff0044;font-weight:400">0xE8</span>, <span style="color:#ff0044;font-weight:400">0xDA</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>, <span style="color:#ff0044;font-weight:400">0xFF</span>,<br />    <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x89</span>, <span style="color:#ff0044;font-weight:400">0x45</span>, <span style="color:#ff0044;font-weight:400">0xF0</span>, <span style="color:#ff0044;font-weight:400">0xB8</span>, <span style="color:#ff0044;font-weight:400">0x04</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xBB</span>, <span style="color:#ff0044;font-weight:400">0x01</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x89</span>, <span style="color:#ff0044;font-weight:400">0xF1</span>, <span style="color:#ff0044;font-weight:400">0x8B</span>, <span style="color:#ff0044;font-weight:400">0x55</span>, <span style="color:#ff0044;font-weight:400">0xF0</span>, <span style="color:#ff0044;font-weight:400">0xCD</span>, <span style="color:#ff0044;font-weight:400">0x80</span>, <span style="color:#ff0044;font-weight:400">0x48</span>, <span style="color:#ff0044;font-weight:400">0x83</span>,<br />    <span style="color:#ff0044;font-weight:400">0xC4</span>, <span style="color:#ff0044;font-weight:400">0x10</span>, <span style="color:#ff0044;font-weight:400">0x5D</span>, <span style="color:#ff0044;font-weight:400">0xC3</span>, <span style="color:#ff0044;font-weight:400">0xB8</span>, <span style="color:#ff0044;font-weight:400">0x01</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xBB</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>,<br />    <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0x00</span>, <span style="color:#ff0044;font-weight:400">0xCD</span>, <span style="color:#ff0044;font-weight:400">0x80</span><br />  },<br />  <span style="color:#0088ff;font-weight:400">/* pad2 */</span><br />  { <span style="color:#ff0044;font-weight:400">0</span> },<br />  <span style="color:#0088ff;font-weight:400">/* data */</span><br />  <span style="color:#3ad900;font-weight:400">&quot;La flag es flag{*************}\n\0Gracias por portarte bien :)\n\0Muy mal&quot;</span><br />    <span style="color:#3ad900;font-weight:400">&quot; hecho :&#39;(\n&quot;</span>,<br />  <span style="color:#0088ff;font-weight:400">/* pad3 */</span><br />  { <span style="color:#ff0044;font-weight:400">0</span> },<br />  <span style="color:#0088ff;font-weight:400">/* symtab */</span><br />  {<br />    { <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, SHN_UNDEF, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* the.asm */</span><br />    { <span style="color:#ff0044;font-weight:400">1</span>, ELF64_ST_INFO(STB_LOCAL, STT_FILE), STV_DEFAULT, SHN_ABS, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* flag */</span><br />    { <span style="color:#ff0044;font-weight:400">27</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_DATA,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data), <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* gracias */</span><br />    { <span style="color:#ff0044;font-weight:400">9</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_DATA,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data) + <span style="color:#ff0044;font-weight:400">0x20</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* mal */</span><br />    { <span style="color:#ff0044;font-weight:400">17</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_DATA,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data) + <span style="color:#ff0044;font-weight:400">0x3E</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* print_flag */</span><br />    { <span style="color:#ff0044;font-weight:400">21</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text), <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* read_line */</span><br />    { <span style="color:#ff0044;font-weight:400">32</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0x18</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* read_loop */</span><br />    { <span style="color:#ff0044;font-weight:400">42</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0x31</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* not_bad */</span><br />    { <span style="color:#ff0044;font-weight:400">52</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0xA3</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* sigue */</span><br />    { <span style="color:#ff0044;font-weight:400">60</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0xB0</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* len */</span><br />    { <span style="color:#ff0044;font-weight:400">66</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0xB2</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* len_start */</span><br />    { <span style="color:#ff0044;font-weight:400">70</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0xB9</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* print */</span><br />    { <span style="color:#ff0044;font-weight:400">80</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0xCB</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* end */</span><br />    { <span style="color:#ff0044;font-weight:400">106</span>, ELF64_ST_INFO(STB_LOCAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">0xF4</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* _start */</span><br />    { <span style="color:#ff0044;font-weight:400">73</span>, ELF64_ST_INFO(STB_GLOBAL, STT_NOTYPE), STV_DEFAULT, SHN_TEXT,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text) + <span style="color:#ff0044;font-weight:400">14</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* __bss_start */</span><br />    { <span style="color:#ff0044;font-weight:400">86</span>, ELF64_ST_INFO(STB_GLOBAL, STT_NOTYPE), STV_DEFAULT, SHN_DATA,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, pad3), <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* _edata */</span><br />    { <span style="color:#ff0044;font-weight:400">98</span>, ELF64_ST_INFO(STB_GLOBAL, STT_NOTYPE), STV_DEFAULT, SHN_DATA,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, pad3), <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* _end */</span><br />    { <span style="color:#ff0044;font-weight:400">105</span>, ELF64_ST_INFO(STB_GLOBAL, STT_NOTYPE), STV_DEFAULT, SHN_DATA,<br />      <span style="color:#ff0044;font-weight:400">0x402058</span>, <span style="color:#ff0044;font-weight:400">0</span> }<br />  },<br />  <span style="color:#0088ff;font-weight:400">/* strtab */</span><br />  <span style="color:#3ad900;font-weight:400">&quot;\0the.asm\0gracias\0mal\0print_flag\0read_line\0read_loop\0not_bad\0sigue&quot;</span><br />    <span style="color:#3ad900;font-weight:400">&quot;\0len\0len_start\0print\0__bss_start\0_edata\0_end&quot;</span>,<br />  <span style="color:#0088ff;font-weight:400">/* shstrtab */</span><br />  <span style="color:#3ad900;font-weight:400">&quot;\0.symtab\0.strtab\0.shstrtab\0.text\0.data&quot;</span>,<br />  <span style="color:#0088ff;font-weight:400">/* pad4 */</span><br />  { <span style="color:#ff0044;font-weight:400">0</span> },<br />  <span style="color:#0088ff;font-weight:400">/* shdrs */</span><br />  {<br />    { <span style="color:#ff0044;font-weight:400">0</span>, SHT_NULL, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, SHN_UNDEF, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* .text */</span><br />    { <span style="color:#ff0044;font-weight:400">27</span>, SHT_PROGBITS, SHF_EXECINSTR | SHF_ALLOC,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text), <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, text), <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.text,<br />      SHN_UNDEF, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0x10</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* .data */</span><br />    { <span style="color:#ff0044;font-weight:400">33</span>, SHT_PROGBITS, SHF_WRITE | SHF_ALLOC,<br />      ADDR_TEXT + <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data), <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, data), <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.data,<br />      SHN_UNDEF, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">4</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* .symtab */</span><br />    { <span style="color:#ff0044;font-weight:400">1</span>, SHT_SYMTAB, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, symtab), <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.symtab,<br />      SHN_STRTAB, <span style="color:#ff0044;font-weight:400">14</span>, <span style="color:#ff9d00;font-weight:400">sizeof</span>(Elf64_Addr), <span style="color:#ff9d00;font-weight:400">sizeof</span>(Elf64_Sym) },<br />    <span style="color:#0088ff;font-weight:400">/* .strtab */</span><br />    { <span style="color:#ff0044;font-weight:400">9</span>, SHT_STRTAB, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, strtab), <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.strtab,<br />      SHN_UNDEF, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">1</span>, <span style="color:#ff0044;font-weight:400">0</span> },<br />    <span style="color:#0088ff;font-weight:400">/* .shstrtab */</span><br />    { <span style="color:#ff0044;font-weight:400">17</span>, SHT_STRTAB, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff9d00;font-weight:400">offsetof</span>(elf, shstrtab), <span style="color:#ff9d00;font-weight:400">sizeof</span> foo.shstrtab,<br />      SHN_UNDEF, <span style="color:#ff0044;font-weight:400">0</span>, <span style="color:#ff0044;font-weight:400">1</span>, <span style="color:#ff0044;font-weight:400">0</span> }<br />  }<br />};<br /></pre></div>
</body>
</html>
