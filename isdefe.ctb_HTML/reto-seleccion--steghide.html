<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>steghide</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>steghide</h1><br/>As we saw in the <a href="reto-seleccion--WireShark.html">WireShark</a> page, the 3rd flag is contained in an image and it&#39;s content is <em><strong>flag{welcome_to_stego}</strong></em>. This flag suggests that the image we downloaded has a file hidden within its binary data, this process is called <em>Steganography</em>. There are several tools tha can be used to detect, insert and extract files with steganography, we are going to use <em><strong>steghide</strong></em>, available in linux apt repos.<br /><div class="codebox"><pre><span style="color:#ff9d00;font-weight:700">sudo</span> apt <span style="color:#ff9d00;font-weight:700">install</span> steghide</pre></div><br /><br />With the help of steghide we try to extract the supposed hidden file inside <em><strong>flag3.jpeg</strong></em>. The execution of the program to extract embedded files usually go as follows:<br /><div class="codebox"><pre>steghide extract -p passPhrase -sf fileName</pre></div><br />Notice: The files hidden with stego are usually password protected, in our first try we will insert an empty passphrase and if we fail we could try guessing or brute forcing the password. With the <em><strong>-sf fileName</strong></em> parameter we specify the name of the file from where to extract the hidden file.<br /><br />Let&#39;s run this program against the file <em><strong>flag3.jpeg</strong></em> and try to extract any file hidden with an empty passphrase:<br /><div class="codebox"><pre>alex@DESKTOP-MQKMDU5<span style="color:#ff9d00;font-weight:700">:/</span>mnt<span style="color:#ff9d00;font-weight:700">/</span>c<span style="color:#ff9d00;font-weight:700">/</span>Ciberseg<span style="color:#ff9d00;font-weight:700">/</span>reto_seleccion$ steghide extract -p <span style="color:#3ad900;font-weight:400">&quot;&quot;</span> -sf flags<span style="color:#ff9d00;font-weight:700">/</span>flag3.jpeg <br />wrote extracted data to <span style="color:#3ad900;font-weight:400">&quot;flag.txt&quot;</span>.<br />alex@DESKTOP-MQKMDU5<span style="color:#ff9d00;font-weight:700">:/</span>mnt<span style="color:#ff9d00;font-weight:700">/</span>c<span style="color:#ff9d00;font-weight:700">/</span>Ciberseg<span style="color:#ff9d00;font-weight:700">/</span>reto_seleccion$ <span style="color:#ff9d00;font-weight:700">cat</span> flag.txt <br />flag<span style="color:#ff9d00;font-weight:700">{</span>este_es_casi_el_final<span style="color:#ff9d00;font-weight:700">}</span><br /><br /><br /><br /><br /><br /><br /><br /><br />alex@DESKTOP-MQKMDU5<span style="color:#ff9d00;font-weight:700">:/</span>mnt<span style="color:#ff9d00;font-weight:700">/</span>c<span style="color:#ff9d00;font-weight:700">/</span>Ciberseg<span style="color:#ff9d00;font-weight:700">/</span>reto_seleccion$</pre></div><br /><br />At this point we discovered the 4th flag: <em><strong>flag{este_es_casi_el_final}</strong></em>, that suggests we are almost at the end of the challenge.</div>
</body>
</html>
